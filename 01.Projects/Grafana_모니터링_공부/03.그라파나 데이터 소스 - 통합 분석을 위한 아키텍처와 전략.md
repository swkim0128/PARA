## 1. 아키텍처의 핵심 추상화 계층 (Foundational Abstraction)

Grafana 아키텍처는 자체적으로 데이터를 저장하지 않고, 외부 저장소에 대한 연결을 관리하는 **벤더 중립적(Vendor-neutral) 인터페이스**로 설계되었습니다.

- **백엔드 커넥터:** 데이터 소스는 Prometheus(메트릭), Loki(로그), Tempo(트레이스)와 같은 시계열 데이터베이스(TSDB)나 MySQL 같은 관계형 데이터베이스에 대한 연결을 추상화한 객체입니다.

- **통합 분석 환경:** 이 추상화 덕분에 사용자는 서로 다른 이기종 데이터 소스(예: AWS CloudWatch 메트릭과 온프레미스 Elasticsearch 로그)를 하나의 대시보드 내에서, 심지어는 `--Mixed--` 데이터 소스 기능을 통해 하나의 패널 내에서 시각화하고 상호 연관 지을 수 있습니다.

## 2. 관측 가능성 3요소의 통합 (LGTM 스택)

Grafanㅓ 아키텍처에서 데이터 소스는 **관측 가능성의 3요소(Metrics, Logs, Traces)**를 유기적으로 연결하는 매개체입니다. 이를 **LGTM 스택** (Loki, Grafana, Tempo, Mimir)이라고 부릅니다.

- **상관관계(Correlation) 구현:** 데이터 소스 간의 연결은 **공유 메타데이터**와 **Trace ID**를 통해 기술적으로 구현됩니다.
    - **Metrics to Traces (Exemplars):** Prometheus 데이터 소스 설정 시 **Exemplars(예시)** 기능을 활성화하면, 메트릭의 스파이크 지점에서 관련 Trace ID를 추출하여 Tempo 데이터 소스로 즉시 이동하는 내부 링크를 생성할 수 있습니다.
    - **Trace to Logs:** Tempo와 같은 트레이스 데이터 소스에서 **파생 필드(Derived Fields)**를 설정하여 트레이스 스팬(Span)에서 관련 로그(Loki)로 이동하는 워크플로우를 구축합니다.

## 3. 보안 및 거버넌스 아키텍처

엔터프라이즈 환경에서 데이터 소스는 보안 경계의 최전선에 위치하므로, Grafana는 데이터 소스 레벨에서 강력한 보안 및 거버넌스 기능을 제공합니다.

- **비밀 관리 (Secrets Management):** 데이터 소스 연결에 필요한 자격 증명(비밀번호, API 토큰)은 평문으로 저장되지 않으며, AWS KMS, Azure Key Vault, HashiCorp Vault와 같은 외부 키 관리 시스템(KMS)과 통합하여 암호화됩니다.

- **접근 제어 (RBAC/LBAC):** 데이터 소스 설정 및 조회 권한은 역할 기반(RBAC)으로 제어되며, 엔터프라이즈 버전에서는 **레이블 기반 액세스 제어(LBAC)**를 통해 특정 레이블(예: `env=prod`)이 포함된 데이터 소스만 특정 팀에게 노출하는 세밀한 데이터 거버넌스를 구현합니다.

- **프라이빗 연결 (PDC):** Grafana Cloud 아키텍처에서는 **PDC(Private Data Source Connect)**를 통해 공용 인터넷에 데이터를 노출하지 않고도 프라이빗 네트워크(VPC) 내의 데이터 소스에 안전하게 접근하는 터널링 기술을 제공합니다.

## 4. 쿼리 및 성능 최적화 계층

데이터 소스는 단순한 연결 통로가 아니라, 쿼리 성능을 제어하고 최적화하는 설정 지점입니다.

- **쿼리 언어 추상화:** 각 데이터 소스는 고유한 쿼리 언어(PromQL, LogQL, Flux, SQL)를 사용하지만, Grafana는 이를 공통된 UI(Query Editor)로 감싸 사용자 경험을 통일합니다.

- **성능 튜닝:** 데이터 소스 설정에서 **스크랩 간격(Scrape Interval)**, **최대 시리즈 수(Max Series)**, **타임아웃(Timeout)**, **캐시 레벨(Cache Level)** 등을 조정하여 대시보드 로딩 속도와 백엔드 부하를 관리합니다.

- **최소 권한 원칙:** MySQL과 같은 SQL 데이터 소스를 연결할 때, Grafana는 `DROP`이나 `DELETE` 권한이 없는 읽기 전용(SELECT) 계정을 사용하도록 권장하여 아키텍처의 안전성을 확보합니다.

## 5. 인프라로서의 코드 (Provisioning)

운영 효율성을 위해 데이터 소스 자체를 **코드(Infrastructure as Code)**로 관리하는 것이 Grafana 아키텍처의 핵심 전략입니다.

- **프로비저닝:** 데이터 소스를 UI에서 수동으로 추가하는 대신, YAML 설정 파일이나 Terraform을 사용하여 선언적으로 정의합니다. 이를 통해 데이터 소스 설정을 버전 관리하고, 개발/스테이징/운영 환경 간의 일관성을 유지하며, 재해 복구 시 신속한 복원을 가능하게 합니다.

## 요약

결론적으로 **데이터 소스**는 Grafana 아키텍처에서 **"데이터의 물리적 위치와 시각화 논리를 분리하는 추상화 계층"**입니다. 이를 통해 사용자는 **1) LGTM 스택을 통한 데이터 상관관계 분석, 2) KMS 및 PDC를 활용한 엔터프라이즈급 보안, 3) 프로비저닝을 통한 자동화된 인프라 관리**를 수행할 수 있게 됩니다.
