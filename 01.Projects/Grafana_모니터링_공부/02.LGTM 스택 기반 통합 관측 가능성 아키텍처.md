## 1. LGTM 스택의 구성과 역할: 통합 데이터 소스 아키텍처

Grafana 아키텍처의 핵심은 다양한 백엔드 저장소를 **데이터 소스(Data Sources)**라는 추상화 계층을 통해 연결하는 것입니다. LGTM 스택은 이 아키텍처 내에서 관측 가능성의 3대 요소를 담당하는 Grafana Labs의 큐레이션 된 스택입니다.

- **L (Loki):** 로그 집계를 담당합니다. Prometheus와 유사한 라벨링 시스템을 사용하여 로그를 인덱싱하므로 메트릭과 로그 간의 상관관계 분석에 최적화되어 있습니다.

- **G (Grafana):** 시각화 및 분석의 허브 역할을 합니다. 서로 다른 데이터 소스(Mimir, Loki, Tempo)의 데이터를 단일 대시보드와 패널로 통합하여 "단일 창(Single-pane-of-glass)" 모니터링 환경을 제공합니다.

- **T (Tempo):** 고도로 확장 가능한 분산 트레이싱 백엔드입니다. 요청의 흐름을 추적하여 대기 시간과 병목 현상을 파악합니다.

- **M (Mimir):** 확장 가능한 메트릭 백엔드입니다. Prometheus와 호환되며 대규모 시계열 데이터를 저장하고 쿼리합니다.

## 2. 상관관계(Correlation) 중심의 아키텍처

LGTM 스택이 Grafana 아키텍처에서 갖는 진정한 가치는 각 데이터가 **공유된 메타데이터(Shared Metadata)**와 **Trace ID**를 통해 심리스하게 연결된다는 점입니다. 이는 수동적인 검색 과정을 **"가이드된 탐색(Guided Navigation)"**으로 전환합니다.

- **Metrics to Traces (Exemplars):** Grafana 대시보드의 메트릭 그래프에서 이상 징후(Spike)가 발생했을 때, 해당 데이터 포인트에 연결된 **Exemplar(예시)**를 클릭하면 즉시 Tempo의 트레이스 뷰로 이동하여 구체적인 트랜잭션 경로를 확인할 수 있습니다.

- **Traces to Logs (Derived Fields):** Tempo에서 트레이스 스팬(Span)을 분석할 때, **파생 필드(Derived Fields)** 기능을 통해 해당 요청 처리 과정에서 생성된 Loki 로그로 직접 이동할 수 있습니다. 이는 "어디서(Trace)" 문제가 발생했는지 파악한 후 "왜(Log)" 발생했는지 문맥을 즉시 제공합니다.

- **Logs to Traces:** 구조화된 로그 내에 포함된 `trace_id`를 통해 다시 트레이스 뷰로 이동하거나 메트릭과 연관 지어 분석하는 양방향 탐색이 가능합니다.

## 3. 운영 효율성과 MTTR 단축

이러한 통합 아키텍처는 시스템 운영의 효율성을 극대화합니다.

- **컨텍스트 유지:** 사용자는 별도의 도구를 오갈 필요 없이 Grafana라는 하나의 인터페이스 내에서 메트릭(거시적 상태) → 트레이스(인과 관계) → 로그(세부 문맥)로 이어지는 흐름을 끊김 없이 따라갈 수 있습니다.

- **데이터 일관성:** Loki, Mimir, Tempo는 모두 Grafana의 공통된 라벨링 및 쿼리 방식과 호환되도록 설계되어 있어, 데이터 간의 상관관계를 구축하고 유지하는 데 드는 오버헤드를 최소화합니다.

- **평균 복구 시간(MTTR) 단축:** Grafana Assistant와 같은 AI 도구는 이 연결된 신호들을 분석하여 "CPU 스파이크가 로그의 에러 급증과 일치하는가?"와 같은 질문에 답함으로써 문제 해결 속도를 획기적으로 줄여줍니다.

## 결론

Grafana 아키텍처 내에서 **LGTM 스택**은 단순한 제품의 나열이 아닙니다. 이는 **"메트릭으로 문제를 감지하고, 트레이스로 위치를 파악하며, 로그로 원인을 규명한다"**는 관측 가능성의 이상적인 워크플로우를 **Trace ID와 메타데이터 기반의 강력한 상관관계**를 통해 기술적으로 구현한 **완전한 관측 가능성 생태계**입니다.
